<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Basilisk Actuator Control Library: control_loop::BrushlessFOCControlLoop Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Basilisk Actuator Control Library
   </div>
   <div id="projectbrief">Hardware-agnostic library enabling control of of PMSM and BLDC Motors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classcontrol__loop_1_1BrushlessFOCControlLoop.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">control_loop::BrushlessFOCControlLoop Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A control loop for a brushless motor.  
 <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="brushless__foc__control__loop_8hpp_source.html">brushless_foc_control_loop.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for control_loop::BrushlessFOCControlLoop:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classcontrol__loop_1_1BrushlessFOCControlLoop.png" usemap="#control_5Floop::BrushlessFOCControlLoop_map" alt=""/>
  <map id="control_5Floop::BrushlessFOCControlLoop_map" name="control_5Floop::BrushlessFOCControlLoop_map">
<area href="classcontrol__loop_1_1ControlLoop.html" title="An abstract class for a control loop." alt="control_loop::ControlLoop" shape="rect" coords="0,0,239,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFOCControlLoopParams.html">BrushlessFOCControlLoopParams</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The parameters for the control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFOCControlLoopParams.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFocControLoopParams.html">BrushlessFocControLoopParams</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The parameters used by the FOC control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFocControLoopParams.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCFrameVars.html">FOCFrameVars</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">FOC Computation 'Frame' that contains the inputs and outputs of the FOC computation.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCFrameVars.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCInputs.html">FOCInputs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inputs to the FOC control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCInputs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a52d1e9c081fa79b28ea4a8927b2feb46"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a52d1e9c081fa79b28ea4a8927b2feb46">BrushlessFOCControlLoopState</a> { <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a52d1e9c081fa79b28ea4a8927b2feb46a615a46af313786fc4e349f34118be111">STOP</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a52d1e9c081fa79b28ea4a8927b2feb46a855520d2a5b0b1a64b939e7e30889e2a">RUN</a>
 }</td></tr>
<tr class="memdesc:a52d1e9c081fa79b28ea4a8927b2feb46"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state of the control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a52d1e9c081fa79b28ea4a8927b2feb46">More...</a><br /></td></tr>
<tr class="separator:a52d1e9c081fa79b28ea4a8927b2feb46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d358aa95ca39823141ee4ddec37cb77"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a1d358aa95ca39823141ee4ddec37cb77">BrushlessFOCControlLoopType</a> { <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a1d358aa95ca39823141ee4ddec37cb77a8962a9ac03b4abae53d6aea79b374f7d">OPEN_LOOP</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a1d358aa95ca39823141ee4ddec37cb77ac93cbe662724bdf917fa63f23f7ed24e">CLOSED_LOOP</a>
 }</td></tr>
<tr class="memdesc:a1d358aa95ca39823141ee4ddec37cb77"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of control loop control.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a1d358aa95ca39823141ee4ddec37cb77">More...</a><br /></td></tr>
<tr class="separator:a1d358aa95ca39823141ee4ddec37cb77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fa607109f9d22c23291fcfe8338bef"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338bef">BrushlessFOCControlLoopError</a> : uint8_t { <br />
&#160;&#160;<a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338befa0cd6b9e67d140d1435f7fc03bb0b957e">PARAMS_NOT_SET</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338befa631c04245b6bb2f1e32836b9ab6dc835">BUS_VOLTAGE_READ_FAILURE</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338befa91c91be2d1156081d63e88df77fbf5dd">PHASE_COMMAND_FAILURE</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338befab0dc3c5d9a31dea9f106475235d3f199">PHASE_CURRENT_READ_FAILURE</a>
, <br />
&#160;&#160;<a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338befa6e9c9accecd8a3488f6b01bb787d60cf">TOTAL_ERROR_COUNT</a>
<br />
 }</td></tr>
<tr class="memdesc:a63fa607109f9d22c23291fcfe8338bef"><td class="mdescLeft">&#160;</td><td class="mdescRight">The error conditions for the brushless control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338bef">More...</a><br /></td></tr>
<tr class="separator:a63fa607109f9d22c23291fcfe8338bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a073264fb45e03329dc192a5b4110cd"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cd">BrushlessFOCControlLoopWarning</a> : uint8_t { <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cda5fc06cab7c6b407aa65850d0040a7c67">ROTOR_ESTIMATOR_UPDATE_FAILURE</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cda47c3cc52f4dacf6c0d71079a797a23ef">NO_VALID_ROTOR_POSITION_ESTIMATOR</a>
, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cda0d66606d62a5d665d9037a4a95a04224">TOTAL_WARNING_COUNT</a>
 }</td></tr>
<tr class="memdesc:a3a073264fb45e03329dc192a5b4110cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The warning conditions for the brushless control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cd">More...</a><br /></td></tr>
<tr class="separator:a3a073264fb45e03329dc192a5b4110cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645b478da79fdf084f5b7751d01d7620"><td class="memItemLeft" align="right" valign="top"><a id="a645b478da79fdf084f5b7751d01d7620"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a645b478da79fdf084f5b7751d01d7620">BrushlessFOCControlLoopStatus</a> = <a class="el" href="classcontrol__loop_1_1ControlLoop_1_1ControlLoopStatus.html">ControlLoopStatus</a>&lt; <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338bef">BrushlessFOCControlLoopError</a>, <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cd">BrushlessFOCControlLoopWarning</a> &gt;</td></tr>
<tr class="memdesc:a645b478da79fdf084f5b7751d01d7620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detailed status of the FOC control loop. <br /></td></tr>
<tr class="separator:a645b478da79fdf084f5b7751d01d7620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classcontrol__loop_1_1ControlLoop"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classcontrol__loop_1_1ControlLoop')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classcontrol__loop_1_1ControlLoop.html">control_loop::ControlLoop</a></td></tr>
<tr class="memitem:a502ccbb2b0ea80e67af8cc4de130ec66 inherit pub_types_classcontrol__loop_1_1ControlLoop"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">ControlLoopBaseStatus</a> { <a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66ae0aa021e21dddbd6d8cecec71e9cf564">OK</a>
, <a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66a059e9861e0400dfbe05c98a841f3f96b">WARNING</a>
, <a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>
 }</td></tr>
<tr class="memdesc:a502ccbb2b0ea80e67af8cc4de130ec66"><td class="mdescLeft">&#160;</td><td class="mdescRight">The status of the control loop in a simplified enum - this is used to return the status of the base control loop to provide an easy to use API.  <a href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">More...</a><br /></td></tr>
<tr class="separator:a502ccbb2b0ea80e67af8cc4de130ec66 inherit pub_types_classcontrol__loop_1_1ControlLoop"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5f3977df12c1275ecdba056397eb251e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a645b478da79fdf084f5b7751d01d7620">BrushlessFOCControlLoopStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a5f3977df12c1275ecdba056397eb251e">get_status</a> () const</td></tr>
<tr class="memdesc:a5f3977df12c1275ecdba056397eb251e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the status of the control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a5f3977df12c1275ecdba056397eb251e">More...</a><br /></td></tr>
<tr class="separator:a5f3977df12c1275ecdba056397eb251e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac177054a71a0bea02e3d113e31e5d59c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#ac177054a71a0bea02e3d113e31e5d59c">BrushlessFOCControlLoop</a> (<a class="el" href="classhwbridge_1_1Bridge3Phase.html">hwbridge::Bridge3Phase</a> &amp;motor, <a class="el" href="classbasilisk__hal_1_1HAL__CLOCK.html">basilisk_hal::HAL_CLOCK</a> &amp;clock, <a class="el" href="classbldc__rotor__estimator_1_1ElectricalRotorPosEstimator.html">bldc_rotor_estimator::ElectricalRotorPosEstimator</a> *rotor_position_estimators[], size_t num_rotor_position_estimators)</td></tr>
<tr class="memdesc:ac177054a71a0bea02e3d113e31e5d59c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html" title="A control loop for a brushless motor.">BrushlessFOCControlLoop</a> object.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#ac177054a71a0bea02e3d113e31e5d59c">More...</a><br /></td></tr>
<tr class="separator:ac177054a71a0bea02e3d113e31e5d59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c857c12e6837c4ce67cfb1b04d5be0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a6c857c12e6837c4ce67cfb1b04d5be0c">init</a> (<a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFOCControlLoopParams.html">BrushlessFOCControlLoopParams</a> *params)</td></tr>
<tr class="memdesc:a6c857c12e6837c4ce67cfb1b04d5be0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a6c857c12e6837c4ce67cfb1b04d5be0c">More...</a><br /></td></tr>
<tr class="separator:a6c857c12e6837c4ce67cfb1b04d5be0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4fb2df8337d72e7375a7a3e5794e715"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">ControlLoop::ControlLoopBaseStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#ae4fb2df8337d72e7375a7a3e5794e715">run</a> (float speed) override</td></tr>
<tr class="memdesc:ae4fb2df8337d72e7375a7a3e5794e715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the control loop.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#ae4fb2df8337d72e7375a7a3e5794e715">More...</a><br /></td></tr>
<tr class="separator:ae4fb2df8337d72e7375a7a3e5794e715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bce32f48b4968cc94e214b602e0d69a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">ControlLoop::ControlLoopBaseStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a4bce32f48b4968cc94e214b602e0d69a">run_current_control</a> (float i_d_reference, float i_q_reference)</td></tr>
<tr class="memdesc:a4bce32f48b4968cc94e214b602e0d69a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the control loop in current control mode.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a4bce32f48b4968cc94e214b602e0d69a">More...</a><br /></td></tr>
<tr class="separator:a4bce32f48b4968cc94e214b602e0d69a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abacb43a1cd0b0ce2587be37b573660c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCFrameVars.html">FOCFrameVars</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#abacb43a1cd0b0ce2587be37b573660c3">get_foc_frame_computation</a> () const</td></tr>
<tr class="memdesc:abacb43a1cd0b0ce2587be37b573660c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the FOC frame variables of the most recent control loop iteration.  <a href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#abacb43a1cd0b0ce2587be37b573660c3">More...</a><br /></td></tr>
<tr class="separator:abacb43a1cd0b0ce2587be37b573660c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_attribs_classcontrol__loop_1_1ControlLoop"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classcontrol__loop_1_1ControlLoop')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classcontrol__loop_1_1ControlLoop.html">control_loop::ControlLoop</a></td></tr>
<tr class="memitem:a8e887bdfeaeee697c56109c5a882cb41 inherit pub_static_attribs_classcontrol__loop_1_1ControlLoop"><td class="memItemLeft" align="right" valign="top"><a id="a8e887bdfeaeee697c56109c5a882cb41"></a>
static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a8e887bdfeaeee697c56109c5a882cb41">MAX_MOTOR_SPEED</a> = 1.0f</td></tr>
<tr class="memdesc:a8e887bdfeaeee697c56109c5a882cb41 inherit pub_static_attribs_classcontrol__loop_1_1ControlLoop"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum motor speed permissable to be commanded. <br /></td></tr>
<tr class="separator:a8e887bdfeaeee697c56109c5a882cb41 inherit pub_static_attribs_classcontrol__loop_1_1ControlLoop"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A control loop for a brushless motor. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a63fa607109f9d22c23291fcfe8338bef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63fa607109f9d22c23291fcfe8338bef">&#9670;&nbsp;</a></span>BrushlessFOCControlLoopError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a63fa607109f9d22c23291fcfe8338bef">control_loop::BrushlessFOCControlLoop::BrushlessFOCControlLoopError</a> : uint8_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The error conditions for the brushless control loop. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a63fa607109f9d22c23291fcfe8338befa0cd6b9e67d140d1435f7fc03bb0b957e"></a>PARAMS_NOT_SET&#160;</td><td class="fielddoc"><p>The control loop parameters are not set (the pointer is null) </p>
</td></tr>
<tr><td class="fieldname"><a id="a63fa607109f9d22c23291fcfe8338befa631c04245b6bb2f1e32836b9ab6dc835"></a>BUS_VOLTAGE_READ_FAILURE&#160;</td><td class="fielddoc"><p>The bus voltage read failed while running the control loop with FOC. </p>
</td></tr>
<tr><td class="fieldname"><a id="a63fa607109f9d22c23291fcfe8338befa91c91be2d1156081d63e88df77fbf5dd"></a>PHASE_COMMAND_FAILURE&#160;</td><td class="fielddoc"><p>The phase duty cycle set command failed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a63fa607109f9d22c23291fcfe8338befab0dc3c5d9a31dea9f106475235d3f199"></a>PHASE_CURRENT_READ_FAILURE&#160;</td><td class="fielddoc"><p>The phase current read from the bridge failed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a63fa607109f9d22c23291fcfe8338befa6e9c9accecd8a3488f6b01bb787d60cf"></a>TOTAL_ERROR_COUNT&#160;</td><td class="fielddoc"><p>The total number of errors. </p>
</td></tr>
</table>

</div>
</div>
<a id="a52d1e9c081fa79b28ea4a8927b2feb46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52d1e9c081fa79b28ea4a8927b2feb46">&#9670;&nbsp;</a></span>BrushlessFOCControlLoopState</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a52d1e9c081fa79b28ea4a8927b2feb46">control_loop::BrushlessFOCControlLoop::BrushlessFOCControlLoopState</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The state of the control loop. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a52d1e9c081fa79b28ea4a8927b2feb46a615a46af313786fc4e349f34118be111"></a>STOP&#160;</td><td class="fielddoc"><p>The control loop is stopped (no PWM output) </p>
</td></tr>
<tr><td class="fieldname"><a id="a52d1e9c081fa79b28ea4a8927b2feb46a855520d2a5b0b1a64b939e7e30889e2a"></a>RUN&#160;</td><td class="fielddoc"><p>The control loop is running. </p>
</td></tr>
</table>

</div>
</div>
<a id="a1d358aa95ca39823141ee4ddec37cb77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d358aa95ca39823141ee4ddec37cb77">&#9670;&nbsp;</a></span>BrushlessFOCControlLoopType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a1d358aa95ca39823141ee4ddec37cb77">control_loop::BrushlessFOCControlLoop::BrushlessFOCControlLoopType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The type of control loop control. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a1d358aa95ca39823141ee4ddec37cb77a8962a9ac03b4abae53d6aea79b374f7d"></a>OPEN_LOOP&#160;</td><td class="fielddoc"><p>The control loop is open loop (not relying on rotor position estimation) </p>
</td></tr>
<tr><td class="fieldname"><a id="a1d358aa95ca39823141ee4ddec37cb77ac93cbe662724bdf917fa63f23f7ed24e"></a>CLOSED_LOOP&#160;</td><td class="fielddoc"><p>The current control loop is in closed loop control. </p>
</td></tr>
</table>

</div>
</div>
<a id="a3a073264fb45e03329dc192a5b4110cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a073264fb45e03329dc192a5b4110cd">&#9670;&nbsp;</a></span>BrushlessFOCControlLoopWarning</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a3a073264fb45e03329dc192a5b4110cd">control_loop::BrushlessFOCControlLoop::BrushlessFOCControlLoopWarning</a> : uint8_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The warning conditions for the brushless control loop. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a3a073264fb45e03329dc192a5b4110cda5fc06cab7c6b407aa65850d0040a7c67"></a>ROTOR_ESTIMATOR_UPDATE_FAILURE&#160;</td><td class="fielddoc"><p>The rotor estimator update failed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a3a073264fb45e03329dc192a5b4110cda47c3cc52f4dacf6c0d71079a797a23ef"></a>NO_VALID_ROTOR_POSITION_ESTIMATOR&#160;</td><td class="fielddoc"><p>There is no valid rotor position estimator (primary or secondary) </p>
</td></tr>
<tr><td class="fieldname"><a id="a3a073264fb45e03329dc192a5b4110cda0d66606d62a5d665d9037a4a95a04224"></a>TOTAL_WARNING_COUNT&#160;</td><td class="fielddoc"><p>The total number of warnings. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac177054a71a0bea02e3d113e31e5d59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac177054a71a0bea02e3d113e31e5d59c">&#9670;&nbsp;</a></span>BrushlessFOCControlLoop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">control_loop::BrushlessFOCControlLoop::BrushlessFOCControlLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classhwbridge_1_1Bridge3Phase.html">hwbridge::Bridge3Phase</a> &amp;&#160;</td>
          <td class="paramname"><em>motor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbasilisk__hal_1_1HAL__CLOCK.html">basilisk_hal::HAL_CLOCK</a> &amp;&#160;</td>
          <td class="paramname"><em>clock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbldc__rotor__estimator_1_1ElectricalRotorPosEstimator.html">bldc_rotor_estimator::ElectricalRotorPosEstimator</a> *&#160;</td>
          <td class="paramname"><em>rotor_position_estimators</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_rotor_position_estimators</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html" title="A control loop for a brushless motor.">BrushlessFOCControlLoop</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">motor</td><td>The bridge on which a singular BLDC/PMSM motor is connected </td></tr>
    <tr><td class="paramname">clock</td><td>The clock to use for the control loop </td></tr>
    <tr><td class="paramname">rotor_position_estimators</td><td>A pointer array to rotor position estimators to use in C-style array </td></tr>
    <tr><td class="paramname">num_rotor_position_estimators</td><td>The number of rotor position estimators </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The secondary rotor position estimator is used when the primary rotor position estimator is not valid </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abacb43a1cd0b0ce2587be37b573660c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abacb43a1cd0b0ce2587be37b573660c3">&#9670;&nbsp;</a></span>get_foc_frame_computation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1FOCFrameVars.html">FOCFrameVars</a> control_loop::BrushlessFOCControlLoop::get_foc_frame_computation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the FOC frame variables of the most recent control loop iteration. </p>
<dl class="section return"><dt>Returns</dt><dd>The FOC frame computation of the most recent control loop iteration </dd></dl>

</div>
</div>
<a id="a5f3977df12c1275ecdba056397eb251e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f3977df12c1275ecdba056397eb251e">&#9670;&nbsp;</a></span>get_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html#a645b478da79fdf084f5b7751d01d7620">BrushlessFOCControlLoopStatus</a> control_loop::BrushlessFOCControlLoop::get_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the status of the control loop. </p>
<dl class="section return"><dt>Returns</dt><dd>The status of the control loop </dd></dl>

</div>
</div>
<a id="a6c857c12e6837c4ce67cfb1b04d5be0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c857c12e6837c4ce67cfb1b04d5be0c">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_loop::BrushlessFOCControlLoop::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop_1_1BrushlessFOCControlLoopParams.html">BrushlessFOCControlLoopParams</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the control loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>The control loop parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>The parameters are not copied, so the parameters must remain in scope for the lifetime of the control loop </dd></dl>

</div>
</div>
<a id="ae4fb2df8337d72e7375a7a3e5794e715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4fb2df8337d72e7375a7a3e5794e715">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">ControlLoop::ControlLoopBaseStatus</a> control_loop::BrushlessFOCControlLoop::run </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>speed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run the control loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">speed</td><td>The desired speed of the motor (note: this is multiplied by the speed_to_iq_gain) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>: speed is from -1 -&gt; 1 </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The status of the control loop </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This function should be called at the desired control loop frequency. For FOC, this is usually after phase current information becomes available, which is at the centre of the inverter PWM cycle. For Trapezodial PWM, this point is at the start of the PWM cycle. The frequency is usually around 15kHz, the same as the switching frequency of the inverter. </dd></dl>

<p>Implements <a class="el" href="classcontrol__loop_1_1ControlLoop.html#a7098bdddb47286a8891aa77a8914676c">control_loop::ControlLoop</a>.</p>

</div>
</div>
<a id="a4bce32f48b4968cc94e214b602e0d69a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bce32f48b4968cc94e214b602e0d69a">&#9670;&nbsp;</a></span>run_current_control()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcontrol__loop_1_1ControlLoop.html#a502ccbb2b0ea80e67af8cc4de130ec66">ControlLoop::ControlLoopBaseStatus</a> control_loop::BrushlessFOCControlLoop::run_current_control </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>i_d_reference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>i_q_reference</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the control loop in current control mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_d_reference</td><td>The desired d current </td></tr>
    <tr><td class="paramname">i_q_reference</td><td>The desired q current </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function shuold only be used when the control loop control type is FOC </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The status of the control loop </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This function should be called at the FOC loop frequency at or after phase current information becomes available<ul>
<li>this is usually around 15kHz and will be in the middle of the PWM cycle (phase is dependent on HW current sensing implementation) </li>
</ul>
</dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>control_loop/bldc/<a class="el" href="brushless__foc__control__loop_8hpp_source.html">brushless_foc_control_loop.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>control_loop</b></li><li class="navelem"><a class="el" href="classcontrol__loop_1_1BrushlessFOCControlLoop.html">BrushlessFOCControlLoop</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
